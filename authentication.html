<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication & Authorization: Securing Your Applications - The Ultimate Whizmath Guide</title>
    <meta name="description" content="A comprehensive guide to authentication and authorization for the Whizmath community, covering core concepts, session-based auth, token-based auth (JWT), OAuth, RBAC, ABAC, and essential security best practices.">
    <meta name="keywords" content="Authentication, Authorization, Security, Web Security, User Management, Sessions, JWT, OAuth, RBAC, ABAC, Password Hashing, HTTPS, OWASP, Whizmath, tutorial, guide, secure applications">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8470165109508371"
     crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Google Fonts - Inter for clean typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <style>
        /* Custom CSS for Three.js Canvas and overall page styling */
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden; /* Prevent horizontal scroll */
            background-color: #1a202c; /* Dark background as a fallback */
            color: #e2e8f0;
            line-height: 1.6;
            scroll-behavior: smooth; /* Smooth scrolling */
        }

        #three-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1; /* Send to back */
            opacity: 0.8; /* Slightly transparent */
        }

        .lesson-container {
            position: relative;
            z-index: 1; /* Keep content above Three.js background */
            background-color: rgba(26, 32, 44, 0.8); /* Semi-transparent dark background for readability */
            backdrop-filter: blur(8px); /* Frosted glass effect */
            -webkit-backdrop-filter: blur(8px); /* For Safari */
            padding: 2rem;
            border-radius: 1.5rem;
            margin: 2rem auto;
            max-width: 90vw; /* Adjust for responsiveness */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
            animation: fadeIn 1s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1, h2, h3, h4 {
            color: #63b3ed; /* A vibrant blue for headings */
            font-weight: 700;
            margin-bottom: 1rem;
        }

        h1 { font-size: 3.5rem; }
        h2 { font-size: 2.5rem; }
        h3 { font-size: 1.875rem; }
        h4 { font-size: 1.5rem; }

        p {
            margin-bottom: 1rem;
        }

        a {
            color: #9f7aea; /* A soft purple for links */
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover {
            color: #b794f4;
            text-decoration: underline;
        }

        ul, ol {
            margin-bottom: 1rem;
            padding-left: 1.5rem;
        }

        ul li { list-style-type: disc; margin-bottom: 0.5rem; }
        ol li { list-style-type: decimal; margin-bottom: 0.5rem; }

        .code-container {
            position: relative;
            background-color: #2d3748; /* Darker background for code blocks */
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
            overflow-x: auto; /* Allow horizontal scrolling for wide code */
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            color: #a0aec0;
            font-size: 0.9rem;
        }

        .code-content {
            font-family: 'Fira Code', 'JetBrains Mono', monospace; /* Monospace font for code */
            font-size: 0.95rem;
            white-space: pre-wrap; /* Preserve whitespace and wrap long lines */
            word-break: break-all;
            color: #cbd5e0;
        }

        .copy-button {
            background-color: #4299e1; /* Blue button */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.1s ease;
            outline: none;
            border: none;
        }

        .copy-button:hover {
            background-color: #3182ce;
            transform: translateY(-1px);
        }

        .copy-button:active {
            transform: translateY(0);
        }

        .copied-feedback {
            position: absolute;
            bottom: 0.5rem;
            right: 0.5rem;
            background-color: #48bb78; /* Green for success */
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 0.3rem;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .copied-feedback.show {
            opacity: 1;
        }

        .back-button {
            position: fixed;
            background-color: #63b3ed;
            color: white;
            border-radius: 9999px; /* Fully rounded */
            padding: 1rem;
            font-size: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, transform 0.2s ease, opacity 0.3s ease;
            z-index: 100;
            top: 2rem; 
            left: 2rem; 
            font-size: 2rem; 
        }

        .back-button:hover {
            background-color: #4299e1;
            transform: translateY(-2px);
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 768px) {
            .lesson-container {
                padding: 1.5rem;
                margin: 1rem auto;
                max-width: 95vw;
            }
            h1 { font-size: 2.5rem; }
            h2 { font-size: 2rem; }
            h3 { font-size: 1.5rem; }
            h4 { font-size: 1.25rem; }
            .back-button {
                top: 1rem;
                left: 1rem;
                padding: 0.75rem;
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <!-- Three.js Background Canvas -->
    <canvas id="three-bg"></canvas>

    <!-- Back to Index Button -->
    <button id="backToIndex" class="back-button">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-8 h-8">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
    </button>

    <!-- Lesson Content Container -->
    <div class="lesson-container">
        <header class="text-center mb-12">
            <h1 class="text-6xl md:text-7xl lg:text-8xl font-extrabold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 via-blue-500 to-indigo-500">
                Whizmath: Mastering Authentic<br>ation & Authori<br>zation
            </h1>
            <p class="text-xl md:text-2xl text-gray-400 mb-8">
                Securing Your Applications with Robust Access Control
            </p>
            <hr class="border-t-2 border-blue-600 w-1/4 mx-auto mb-12" />
        </header>

        <section id="introduction" class="mb-16">
            <h2 class="text-4xl font-bold mb-6 text-blue-400">
                <span class="mr-2 text-purple-400">‚ú®</span> Welcome to Application Security!
            </h2>
            <p>
                Hello, secure developers! Welcome to this comprehensive guide on Authentication and Authorization, powered by Whizmath. In virtually every modern application, whether it's a website, a mobile app, or a backend API, managing user access is a fundamental requirement. This involves two distinct but related concepts: **Authentication** and **Authorization**.
            </p>
            <p>
                Understanding and correctly implementing these security measures is paramount to protecting sensitive user data, preventing unauthorized access, and maintaining the integrity of your application. A single vulnerability in your authentication or authorization logic can lead to severe security breaches.
            </p>
            <p>
                This lesson will walk you through the core differences between these two concepts, explore common implementation methods (like session-based and token-based authentication), delve into authorization models, and provide essential best practices to build secure applications. Let's learn to build software that is both functional and secure!
            </p>
        </section>

        <section id="auth-vs-authz" class="mb-16">
            <h2 class="text-4xl font-bold mb-6 text-blue-400">
                <span class="mr-2 text-green-400">üí°</span> Authentication vs. Authorization
            </h2>
            <p>These two terms are often used interchangeably, but they refer to distinct security processes:</p>
            <h3>Authentication (Who are you?)</h3>
            <p>
                **Authentication** is the process of verifying the identity of a user, system, or process. It answers the question: "Are you who you say you are?"
            </p>
            <p>Common forms of authentication include:</p>
            <ul class="list-disc list-inside mb-4">
                <li>Username and Password</li>
                <li>Biometrics (fingerprint, facial recognition)</li>
                <li>Multi-Factor Authentication (MFA)</li>
                <li>Digital Certificates</li>
            </ul>
            <p>Upon successful authentication, the system trusts the user's identity.</p>

            <h3>Authorization (What are you allowed to do?)</h3>
            <p>
                **Authorization** is the process of determining what an authenticated user (or system) is permitted to access or perform. It answers the question: "What are you allowed to do?"
            </p>
            <p>Once a user is authenticated, the system then checks their authorization to ensure they have the necessary permissions for the requested action or resource. For example, an authenticated user might be allowed to view their own profile but not modify another user's profile.</p>
        </section>

        <section id="authentication-methods" class="mb-16">
            <h2 class="text-4xl font-bold mb-6 text-blue-400">
                <span class="mr-2 text-yellow-400">üîê</span> Authentication Methods & Flows
            </h2>
            <h3>1. Session-Based Authentication</h3>
            <p>
                This is a traditional method, common in server-rendered web applications. When a user logs in, the server creates a **session** (a record of the user's logged-in state) and stores it on the server (e.g., in memory, database, Redis). A unique **session ID** is then sent to the client (usually as a cookie). For subsequent requests, the client sends this session ID, and the server validates it against its stored sessions.
            </p>
            <h4>Flow:</h4>
            <ol class="list-decimal list-inside mb-4">
                <li>User sends login credentials.</li>
                <li>Server validates credentials, creates a session, stores session ID.</li>
                <li>Server sends session ID (in a cookie) to the client.</li>
                <li>Client sends session ID with each subsequent request.</li>
                <li>Server verifies session ID for each request to authenticate.</li>
            </ol>
            <div class="code-container">
                <div class="code-header">
                    <span>Conceptual Server-Side Session Logic (Node.js/Express)</span>
                    <button class="copy-button" onclick="copyCode(this)">Copy Code</button>
                </div>
<pre class="code-content">
// Example: Using express-session middleware
// This is conceptual; requires 'express-session' package and session store setup

const express = require('express');
const session = require('express-session');
const app = express();

app.use(express.json()); // For parsing request bodies
app.use(express.urlencoded({ extended: true })); // For parsing form data

// Configure session middleware
app.use(session({
    secret: 'YOUR_SECRET_KEY', // Should be a strong, unique string
    resave: false,             // Do not save session if unmodified
    saveUninitialized: false,  // Do not create session until something is stored
    cookie: { 
        maxAge: 1000 * 60 * 60 * 24, // 24 hours
        secure: false, // Set to true in production with HTTPS
        httpOnly: true // Prevent client-side JavaScript access to cookie
    }
}));

// Dummy user data
const users = [
    { id: 1, username: 'user1', password: 'password123' }, // In real app, hash passwords!
];

// Login route
app.post('/login', (req, res) => {
    const { username, password } = req.body;
    const user = users.find(u => u.username === username && u.password === password);

    if (user) {
        req.session.userId = user.id; // Store user ID in session
        res.status(200).send('Logged in successfully!');
    } else {
        res.status(401).send('Invalid credentials');
    }
});

// Protected route
app.get('/profile', (req, res) => {
    if (req.session.userId) {
        res.status(200).json({ message: `Welcome, user ${req.session.userId}! This is your profile.`, userId: req.session.userId });
    } else {
        res.status(401).send('Please log in to view your profile.');
    }
});

// Logout route
app.post('/logout', (req, res) => {
    req.session.destroy(err => {
        if (err) {
            return res.status(500).send('Could not log out, please try again.');
        }
        res.status(200).send('Logged out successfully!');
    });
});

app.listen(3000, () => {
    console.log('Session-based auth server running on http://localhost:3000');
    console.log('Test with Postman/curl: POST /login {username: "user1", password: "password123"}');
    console.log('Then GET /profile (cookies will be automatically handled by Postman/browser)');
});
</pre>
            </div>

            <h3>2. Token-Based Authentication (e.g., JWT)</h3>
            <p>
                In token-based authentication, the server doesn't store session state. Instead, it issues a signed **token** (e.g., JSON Web Token - JWT) upon successful login. The client stores this token (e.g., in local storage, cookies) and sends it with each request (typically in the `Authorization` header). The server then verifies the token's signature to authenticate the user. This is popular for RESTful APIs and single-page applications (SPAs) because it's stateless on the server.
            </p>
            <h4>Flow:</h4>
            <ol class="list-decimal list-inside mb-4">
                <li>User sends login credentials.</li>
                <li>Server validates credentials, generates and signs a JWT.</li>
                <li>Server sends JWT to the client.</li>
                <li>Client stores JWT and sends it in `Authorization: Bearer &lt;token&gt;` header with each subsequent request.</li>
                <li>Server verifies the token's signature (and expiration) to authenticate.</li>
            </ol>
            <div class="code-container">
                <div class="code-header">
                    <span>Conceptual JWT Authentication Logic (Node.js/Express)</span>
                    <button class="copy-button" onclick="copyCode(this)">Copy Code</button>
                </div>
<pre class="code-content">
// Example: Using jsonwebtoken and bcryptjs (requires these packages)
// npm install jsonwebtoken bcryptjs express

const express = require('express');
const jwt = require('jsonwebtoken');
const bcrypt = require('bcryptjs');
const app = express();

app.use(express.json());

const JWT_SECRET = 'YOUR_SUPER_SECRET_JWT_KEY'; // Should be a strong, unique, and securely stored key

// Dummy user data (passwords hashed in real app)
const usersDb = [
    { id: 1, username: 'john.doe', hashedPassword: '$2a$10$f6B0n2K8M1b3W5z9C7a4O.J2.X3.Y4.Z5.A6.B7.C8.D9.E0' }, // 'password123' hashed
    { id: 2, username: 'jane.smith', hashedPassword: '$2a$10$a1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6Q7R8S9T0U1V2W3X4Y5Z6A7B8' }, // 'securepass' hashed
];

// Register route (conceptual - for demo purposes)
app.post('/register', async (req, res) => {
    const { username, password } = req.body;
    if (!username || !password) {
        return res.status(400).send('Username and password are required.');
    }

    const hashedPassword = await bcrypt.hash(password, 10);
    const newUser = { id: usersDb.length + 1, username, hashedPassword };
    usersDb.push(newUser);
    res.status(201).json({ message: 'User registered successfully', userId: newUser.id });
});

// Login route
app.post('/login', async (req, res) => {
    const { username, password } = req.body;
    const user = usersDb.find(u => u.username === username);

    if (user && await bcrypt.compare(password, user.hashedPassword)) {
        // Generate JWT
        const token = jwt.sign(
            { userId: user.id, username: user.username },
            JWT_SECRET,
            { expiresIn: '1h' } // Token expires in 1 hour
        );
        res.status(200).json({ message: 'Logged in successfully!', token });
    } else {
        res.status(401).send('Invalid credentials');
    }
});

// Middleware to verify JWT
const authenticateToken = (req, res, next) => {
    const authHeader = req.headers['authorization'];
    const token = authHeader && authHeader.split(' ')[1]; // Expects "Bearer TOKEN"

    if (token == null) return res.status(401).send('Access Denied: No token provided');

    jwt.verify(token, JWT_SECRET, (err, user) => {
        if (err) return res.status(403).send('Access Denied: Invalid token'); // Token invalid or expired
        req.user = user; // Attach user payload to request
        next();
    });
};

// Protected route
app.get('/dashboard', authenticateToken, (req, res) => {
    res.status(200).json({ message: `Welcome to your dashboard, ${req.user.username}!`, userData: req.user });
});

app.listen(3000, () => {
    console.log('JWT-based auth server running on http://localhost:3000');
    console.log('To run this: node server.js');
    console.log('Test with Postman/curl:');
    console.log('1. POST /register {username: "testuser", password: "testpassword"}');
    console.log('2. POST /login {username: "testuser", password: "testpassword"} to get a token');
    console.log('3. GET /dashboard with Authorization: Bearer &lt;token&gt; header');
});
</pre>
            </div>

            <h3>3. OAuth 2.0 (Authorization Framework)</h3>
            <p>
                OAuth 2.0 is an authorization framework that enables an application to obtain limited access to a user's account on an HTTP service, such as Facebook, GitHub, or Google. It does not provide authentication itself but is often combined with OpenID Connect for identity verification. It's commonly used for "Login with Google/Facebook" buttons.
            </p>
            <h4>Key Roles:</h4>
            <ul class="list-disc list-inside mb-4">
                <li>**Resource Owner:** The user who owns the data.</li>
                <li>**Client:** The application requesting access to the resource owner's data.</li>
                <li>**Authorization Server:** Verifies the resource owner's identity and issues access tokens to the client.</li>
                <li>**Resource Server:** Hosts the protected resources and accepts access tokens.</li>
            </ul>
            <p class="text-sm text-gray-400">
                *Implementing OAuth 2.0 involves multiple redirects and interactions between these parties, which is more complex than a single code snippet can convey.*
            </p>
        </section>

        <section id="authorization-models" class="mb-16">
            <h2 class="text-4xl font-bold mb-6 text-blue-400">
                <span class="mr-2 text-cyan-400">üîë</span> Authorization Models
            </h2>
            <p>
                Once a user is authenticated, authorization mechanisms determine what actions they can perform and what data they can access.
            </p>
            <h3>1. Role-Based Access Control (RBAC)</h3>
            <p>
                RBAC assigns permissions to specific roles, and then users are assigned to one or more roles. This simplifies management, especially in larger systems, as you don't assign permissions directly to individual users.
            </p>
            <h4>Examples of Roles:</h4>
            <ul class="list-disc list-inside mb-4">
                <li>`Admin`: Can manage all users, create/delete content, change settings.</li>
                <li>`Editor`: Can create/update content, but not delete users.</li>
                <li>`Viewer`: Can only read content.</li>
            </ul>
            <div class="code-container">
                <div class="code-header">
                    <span>Conceptual RBAC Middleware (Node.js/Express)</span>
                    <button class="copy-button" onclick="copyCode(this)">Copy Code</button>
                </div>
<pre class="code-content">
// Assuming req.user is populated by an authentication middleware (e.g., JWT)
const authorizeRole = (requiredRole) => {
    return (req, res, next) => {
        if (!req.user || !req.user.role) {
            return res.status(403).send('Forbidden: No role assigned or authenticated.');
        }
        if (req.user.role === requiredRole) {
            next(); // User has the required role, proceed
        } else {
            res.status(403).send('Forbidden: Insufficient permissions.');
        }
    };
};

// Usage in an Express app:
// app.get('/admin-panel', authenticateToken, authorizeRole('admin'), (req, res) => {
//     res.send('Welcome to the Admin Panel!');
// });

// app.post('/articles', authenticateToken, authorizeRole('editor'), (req, res) => {
//     res.status(201).send('Article created!');
// });
</pre>
            </div>

            <h3>2. Attribute-Based Access Control (ABAC)</h3>
            <p>
                ABAC defines permissions based on attributes (characteristics) of the user, the resource, the action, and the environment. It offers much more fine-grained control and flexibility than RBAC.
            </p>
            <h4>Examples of Attributes:</h4>
            <ul class="list-disc list-inside mb-4">
                <li>**User Attributes:** Department, location, security clearance.</li>
                <li>**Resource Attributes:** Owner, sensitivity, creation date.</li>
                <li>**Action Attributes:** Read, write, delete.</li>
                <li>**Environment Attributes:** Time of day, IP address.</li>
            </ul>
            <p>
                **Example Rule:** "A user can read a document if they are in the same department as the document's owner AND the document is not marked 'confidential' AND the time is between 9 AM and 5 PM."
            </p>
            <p class="text-sm text-gray-400">
                *ABAC implementation is significantly more complex and often requires a dedicated policy engine.*
            </p>

            <h3>Permissions (Capabilities)</h3>
            <p>
                Direct permissions define what a user is allowed to do (e.g., "can_edit_profile", "can_delete_post"). RBAC builds upon permissions by grouping them into roles.
            </p>
            <div class="code-container">
                <div class="code-header">
                    <span>Conceptual Permission Check</span>
                    <button class="copy-button" onclick="copyCode(this)">Copy Code</button>
                </div>
<pre class="code-content">
// Assuming req.user.permissions is an array of strings like ['read_users', 'write_articles']

const checkPermission = (permission) => {
    return (req, res, next) => {
        if (!req.user || !req.user.permissions || !req.user.permissions.includes(permission)) {
            return res.status(403).send('Forbidden: Missing required permission.');
        }
        next();
    };
};

// Usage:
// app.delete('/users/:id', authenticateToken, checkPermission('delete_users'), (req, res) => {
//     res.send('User deleted!');
// });
</pre>
            </div>
        </section>

        <section id="security-best-practices" class="mb-16">
            <h2 class="text-4xl font-bold mb-6 text-blue-400">
                <span class="mr-2 text-lime-400">üåü</span> Essential Security Best Practices
            </h2>
            <p>Beyond authentication and authorization mechanisms, overall application security is paramount. Consider these best practices:</p>
            <ul class="list-disc list-inside mb-4">
                <li><strong>Always Use HTTPS:</strong> Encrypt all communication between client and server to prevent eavesdropping and tampering.</li>
                <li><strong>Password Hashing:</strong> Never store plain-text passwords. Use strong, one-way hashing algorithms (e.g., bcrypt, Argon2) with a salt.</li>
                <li><strong>Input Validation:</strong> Validate all input (user-submitted data, API parameters) on the server-side to prevent injection attacks (SQL injection, XSS) and malformed data.</li>
                <li><strong>Rate Limiting:</strong> Implement rate limiting on login attempts and sensitive API endpoints to prevent brute-force attacks.</li>
                <li><strong>Session/Token Management:</strong>
                    <ul class="list-circle list-inside ml-4">
                        <li>**Secure Cookies:** Use `HttpOnly`, `Secure`, `SameSite` flags for session cookies.</li>
                        <li>**Short-lived Tokens:** For JWTs, use short expiration times and implement refresh tokens.</li>
                        <li>**Token Revocation:** Have a mechanism to revoke compromised tokens/sessions.</li>
                    </ul>
                </li>
                <li><strong>Protect Against Common Vulnerabilities:</strong>
                    <ul class="list-circle list-inside ml-4">
                        <li>**Cross-Site Scripting (XSS):** Sanitize user input before rendering it in HTML.</li>
                        <li>**Cross-Site Request Forgery (CSRF):** Use CSRF tokens for sensitive operations.</li>
                        <li>**Security Headers:** Implement appropriate HTTP security headers (e.g., Content-Security-Policy, X-Frame-Options).</li>
                    </ul>
                </li>
                <li><strong>Least Privilege Principle:</strong> Grant users/systems only the minimum necessary permissions to perform their tasks.</li>
                <li><strong>Audit Logging:</strong> Log security-relevant events (failed logins, access to sensitive data) for auditing and incident response.</li>
                <li><strong>Regular Security Audits & Updates:</strong> Regularly review your code for vulnerabilities and keep all libraries and dependencies updated to their latest, secure versions.</li>
                <li>**Educate Yourself:** Stay informed about common web security threats (e.g., OWASP Top 10).</li>
            </ul>
        </section>

        <section id="conclusion" class="mb-16">
            <h2 class="text-4xl font-bold mb-6 text-blue-400">
                <span class="mr-2 text-blue-400">üöÄ</span> Your Security Journey Continues!
            </h2>
            <p>
                Congratulations! You've navigated through the crucial concepts of Authentication and Authorization, understanding their differences, common implementation patterns, and vital security best practices. These are indispensable skills for building secure and trustworthy applications.
            </p>
            <p>
                Application security is an ongoing process, not a one-time setup. The threat landscape constantly evolves, and continuous learning and vigilance are key.
            </p>
            <p>
                We at Whizmath are excited to see you build secure, robust, and reliable software that protects your users and their data. Keep exploring, keep learning, and keep innovating securely!
            </p>
            <h3>Further Learning Resources:</h3>
            <ul class="list-disc list-inside mb-4">
                <li><strong>OWASP Top 10:</strong> <a href="https://owasp.org/www-project-top-ten/" target="_blank" rel="noopener noreferrer">owasp.org/www-project-top-ten/</a> (Essential security risks)</li>
                <li><strong>Auth0 Blog:</strong> <a href="https://auth0.com/blog" target="_blank" rel="noopener noreferrer">auth0.com/blog</a> (Excellent resource for identity and access management)</li>
                <li><strong>JWT.io:</strong> <a href="https://jwt.io/" target="_blank" rel="noopener noreferrer">jwt.io</a> (Information about JSON Web Tokens)</li>
                <li><strong>NIST Guidelines:</strong> For robust security standards.</li>
            </ul>
            <div class="text-center mt-12">
                <a href="programming.html" class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-4 px-8 rounded-full text-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out">
                    Explore More Whizmath Lessons
                </a>
            </div>
        </section>
    </div>

    <button id="main-share-btn"
    class="w-14 h-14 rounded-full bg-blue-600 shadow-xl flex items-center justify-center hover:bg-blue-700 transition duration-300 border-4 border-white dark:border-gray-800 focus:outline-none focus:ring-4 focus:ring-blue-300 group"
    aria-label="Share this page">
    <!-- Replaced img with Font Awesome share-alt icon -->
    <i class="fas fa-share-alt text-white text-2xl"></i>
  </button>
  <!-- Share Options -->
  <div id="share-options"
    class="flex flex-col items-center space-y-2 opacity-0 pointer-events-none group-focus-within:opacity-100 group-focus-within:pointer-events-auto group-hover:opacity-100 group-hover:pointer-events-auto transition-opacity duration-300">
    <!-- WhatsApp -->
    <button class="share-option w-12 h-12 rounded-full bg-green-500 hover:bg-green-600 flex items-center justify-center shadow-lg transition"
      data-network="whatsapp" aria-label="Share on WhatsApp">
      <i class="fab fa-whatsapp text-white text-2xl"></i>
    </button>
    <!-- X (Twitter) -->
    <button class="share-option w-12 h-12 rounded-full bg-gray-800 hover:bg-gray-900 flex items-center justify-center shadow-lg transition"
      data-network="twitter" aria-label="Share on X (Twitter)">
      <i class="fab fa-x-twitter text-white text-2xl"></i>
    </button>
    <!-- Facebook -->
    <button class="share-option w-12 h-12 rounded-full bg-blue-700 hover:bg-blue-800 flex items-center justify-center shadow-lg transition"
      data-network="facebook" aria-label="Share on Facebook">
      <i class="fab fa-facebook-f text-white text-2xl"></i>
    </button>
    <!-- Telegram -->
    <button class="share-option w-12 h-12 rounded-full bg-cyan-500 hover:bg-cyan-600 flex items-center justify-center shadow-lg transition"
      data-network="telegram" aria-label="Share on Telegram">
      <i class="fab fa-telegram-plane text-white text-2xl"></i>
    </button>
    <!-- Copy Link -->
    <button class="share-option w-12 h-12 rounded-full bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 flex items-center justify-center shadow-lg transition"
      data-network="copy" aria-label="Copy Link">
      <i class="fa fa-link text-gray-800 dark:text-gray-100 text-2xl"></i>
    </button>
  </div>
  <!-- Copied Tooltip -->
  <span id="share-copied-tooltip"
    class="absolute left-16 top-6 bg-gray-900 text-white text-xs rounded px-2 py-1 shadow opacity-0 pointer-events-none transition-opacity duration-300">Copied!</span>
</div>

<script>
(function () {
  const mainBtn = document.getElementById('main-share-btn');
  const options = document.getElementById('share-options');
  const tooltip = document.getElementById('share-copied-tooltip');
  let optionsOpen = false;

  // Accessibility: open with keyboard and toggle
  mainBtn.addEventListener('click', () => {
    optionsOpen = !optionsOpen;
    options.style.opacity = optionsOpen ? '1' : '0';
    options.style.pointerEvents = optionsOpen ? 'auto' : 'none';
  });

  // Hide options when clicking outside
  document.addEventListener('click', (e) => {
    if (!mainBtn.contains(e.target) && !options.contains(e.target)) {
      optionsOpen = false;
      options.style.opacity = '0';
      options.style.pointerEvents = 'none';
    }
  });

  // Share logic
  const shareBtns = document.querySelectorAll('.share-option');
  const pageUrl = encodeURIComponent(window.location.href);
  const pageTitle = encodeURIComponent(document.title);

  shareBtns.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      const network = btn.dataset.network;
      let shareLink = '';
      if (network === 'whatsapp') {
        shareLink = `https://wa.me/?text=${pageTitle}%20${pageUrl}`;
        window.open(shareLink, '_blank');
      } else if (network === 'twitter') {
        shareLink = `https://twitter.com/intent/tweet?text=${pageTitle}&url=${pageUrl}`;
        window.open(shareLink, '_blank');
      } else if (network === 'facebook') {
        shareLink = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`;
        window.open(shareLink, '_blank');
      } else if (network === 'telegram') {
        shareLink = `https://t.me/share/url?url=${pageUrl}&text=${pageTitle}`;
        window.open(shareLink, '_blank');
      } else if (network === 'copy') {
        // Using document.execCommand('copy') for broader compatibility within iframes
        const tempInput = document.createElement('textarea');
        tempInput.value = window.location.href;
        document.body.appendChild(tempInput);
        tempInput.select();
        document.execCommand('copy');
        document.body.removeChild(tempInput);

        // Show tooltip
        tooltip.style.opacity = '1';
        setTimeout(() => {
          tooltip.style.opacity = '0';
        }, 1200);
      }
      optionsOpen = false;
      options.style.opacity = '0';
      options.style.pointerEvents = 'none';
    });
  });
})();
</script>

    <script>
        // Three.js Background Animation - Kept separate for clarity
        let scene, camera, renderer, particles, particleMaterial;

        function initThreeJS() {
            if (typeof THREE === 'undefined') {
                console.error("THREE.js is not loaded. Skipping Three.js initialization.");
                return;
            }

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('three-bg'), antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setClearColor(0x1a202c, 1); // Match body background

            camera.position.z = 5;

            const particleCount = 1000;
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);

            const color1 = new THREE.Color(0x63b3ed); // Blue
            const color2 = new THREE.Color(0x9f7aea); // Purple

            for (let i = 0; i < particleCount * 3; i += 3) {
                positions[i] = (Math.random() - 0.5) * 20; // x
                positions[i + 1] = (Math.random() - 0.5) * 20; // y
                positions[i + 2] = (Math.random() - 0.5) * 20; // z

                const mixFactor = Math.random();
                const mixedColor = new THREE.Color().copy(color1).lerp(color2, mixFactor);
                colors[i] = mixedColor.r;
                colors[i + 1] = mixedColor.g;
                colors[i + 2] = mixedColor.b;
            }

            const particleGeometry = new THREE.BufferGeometry();
            particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particleGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

            particleMaterial = new THREE.PointsMaterial({
                size: 0.05,
                vertexColors: true,
                transparent: true,
                opacity: 0.7,
                blending: THREE.AdditiveBlending
            });

            particles = new THREE.Points(particleGeometry, particleMaterial);
            scene.add(particles);

            const ambientLight = new THREE.AmbientLight(0x404040); 
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
            directionalLight.position.set(0, 1, 0);
            scene.add(directionalLight);

            animateThreeJS();
        }

        function animateThreeJS() {
            requestAnimationFrame(animateThreeJS);
            if (particles) {
                particles.rotation.x += 0.0005;
                particles.rotation.y += 0.0008;

                const positions = particles.geometry.attributes.position.array;
                for (let i = 0; i < positions.length; i += 3) {
                    positions[i + 2] += 0.001; 
                    if (positions[i + 2] > camera.position.z + 5) {
                        positions[i + 2] = (Math.random() - 0.5) * 20; 
                    }
                }
                particles.geometry.attributes.position.needsUpdate = true;
            }
            if (renderer && scene && camera) { // Check if all are defined before rendering
                renderer.render(scene, camera);
            }
        }

        function onWindowResizeThreeJS() {
            if (camera && renderer) {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }
        }

        // Common JS function for code copying
        window.copyCode = (button) => {
            const codeBlock = button.parentNode.nextElementSibling;
            const codeText = codeBlock.innerText;

            const textarea = document.createElement('textarea');
            textarea.value = codeText;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            const feedbackSpan = document.createElement('span');
            feedbackSpan.className = 'copied-feedback';
            feedbackSpan.innerText = 'Copied!';
            button.parentNode.appendChild(feedbackSpan);

            setTimeout(() => {
                feedbackSpan.classList.add('show');
            }, 10);

            setTimeout(() => {
                feedbackSpan.classList.remove('show');
                feedbackSpan.addEventListener('transitionend', () => {
                    feedbackSpan.remove();
                }, { once: true });
            }, 1500);
        };

        // Initialize Three.js and other DOM listeners when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Three.js initialization with a small delay
            setTimeout(() => { 
                initThreeJS();
                window.addEventListener('resize', onWindowResizeThreeJS);
            }, 100); 
            
            // Back to Index Button Functionality
            const backToIndexBtn = document.getElementById('backToIndex');
            if (backToIndexBtn) { 
                backToIndexBtn.addEventListener('click', () => {
                    window.location.href = 'index.html'; 
                });
            } else {
                console.error("Back to Index button not found.");
            }
        });
    </script>
</body>
</html>
